---
- name: Ensure k3s configuration directory exists
  ansible.builtin.file:
    path: "{{ k3s_config_dir }}"
    state: directory
    mode: "0755"
  tags: config
  become: true

- name: Deploy k3s configuration file
  ansible.builtin.copy:
    src: config.yaml
    dest: "{{ k3s_config_file }}"
    mode: "0644"
  register: k3s_config_deployed
  tags: config
  become: true

- name: Display configuration deployment status
  ansible.builtin.debug:
    msg:
      - "k3s configuration deployed: {{ k3s_config_deployed.changed }}"
      - "config file: {{ k3s_config_file }}"
  when: k3s_config_deployed.changed
  tags: config
